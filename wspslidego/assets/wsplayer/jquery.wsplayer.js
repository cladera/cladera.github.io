/*! Webcasting Studio JQuery Player 2013-12-11 */
/*! Author: Carlos Galan Cladera < cgcladera@gmail.com > */
!function(a){var b=function(c,d,e){var f;if("string"==typeof c){if(0!==c.indexOf("#")&&(c="#"+c),f=a(c),b.webcasts[f.attr("id")])return b.webcasts[f.attr("id")]}else f=a(c);if(!f.length)throw new TypeError("The element ID supplied is not valid.");return new b.Webcast(f,d,e)};window.wsplayer=window.wsp=b,b.options={video:{skin:"vjs-default-skin",poster:"http://video-js.zencoder.com/oceans-clip.png",preload:"auto",autoplay:!1,controls:!0,width:640,height:264,sources:[{src:"http://video-js.zencoder.com/oceans-clip.mp4",type:"video/mp4"}]},components:{}},b.webcasts={},b.obj={},b.obj.create=Object.create||function(a){function b(){}return b.prototype=a,new b},b.guid=1,b.CoreObject=function(){},b.CoreObject.extend=function(a){var c,d;a=a||{},c=a.init||this.prototype.init||function(){},d=function(){c.apply(this,arguments)},d.prototype=b.obj.create(this.prototype),d.prototype.constructor=d,d.extend=b.CoreObject.extend,d.create=b.CoreObject.create;for(var e in a)a.hasOwnProperty(e)&&(d.prototype[e]=a[e]);return d},b.CoreObject.create=function(){var a=b.obj.create(this.prototype);return this.apply(a,arguments),a},b.Webcast=b.CoreObject.extend({init:function(c,d,e){this.ready=e||this.ready;var f=this.container_=a(c);f.addClass("wsp-container"),f=a(c),f.addClass("wsp-container");var g=void 0!==f.attr("id")?f.attr("id"):"wsplayer";f.attr("id",g),b.webcasts[g]=this,this.options=a.extend(!0,{},b.options,d),this.createPlayer();var h=this;this.options.plugins&&a.each(h.options.plugins,function(a,b){h[a](b)})}}),b.Webcast.prototype.dispose=function(){this.player&&this.player.dispose&&this.player.dispose(),this.player=null,this.components_&&a.each(this.components_,function(a,b){b.dispose&&b.dispose()}),this.components_=null,this.isReady_=!1},b.Webcast.prototype.ready=function(){},b.Webcast.prototype.triggerReady_=function(){this.isReady_=!0,this.ready.call(this)},b.Webcast.prototype.isReady_=!1,b.Webcast.prototype.player={},b.Webcast.prototype.components_={},b.Webcast.prototype.options=null,b.Webcast.prototype.container_={},b.Webcast.prototype.container=function(){return this.container_},b.Webcast.prototype.id=function(){return this.container_.attr("id")},b.Webcast.prototype.createPlayer=function(){var b=this.container_,c=a("#"+b.attr("id")+" > video");if(c.length?void 0===c.attr("id")&&(c.attr("id","wsp-video"),c.addClass("wsplayer"),c.addClass("wsp-component")):(c=a("<video></video>"),c.attr("id","wsplayer-video"),c.addClass("video-js"),c.addClass(this.options.video.skin),c.addClass("wsplayer"),c.addClass("wsp-component"),a.each(this.options.video.sources,function(b,d){c.append(a('<source src="'+d.src+'" type="'+d.type+'">'))}),c.attr("width",this.options.video.width),c.attr("height",this.options.video.height),c.attr("controls",this.options.video.controls),c.attr("preload",this.options.video.preload),c.attr("autoplay",this.options.video.autoplay),c.attr("poster",this.options.video.poster),this.options.video.setup&&c.attr("data-setup",JSON.stringify(this.options.video.setup)),b.append(c)),"function"!=typeof videojs)throw new TypeError("VideoJS player not found");var d=this;videojs(c.attr("id"),{},function(){d.player=this,"function"==typeof d.player.cuepoints&&d.player.cuepoints(),d.appendChildren_(),d.triggerReady_()})},b.Webcast.prototype.appendElement=function(a){return this.container_.append(a),this},b.Webcast.prototype.addClass=function(a){return this.container_.addClass(a),this},b.Webcast.prototype.removeClass=function(a){return this.container_.removeClass(a),this},b.Webcast.prototype.hide=function(a){a=a||function(){};var b=this;this.container_.fadeOut(function(){a.call(b)})},b.Webcast.prototype.show=function(a){a=a||function(){};var b=this;this.container_.fadeIn(function(){a.call(b)})},b.Webcast.prototype.appendChildren_=function(){var c=this;this.options.components&&(c.components_={},a.each(this.options.components,function(a,d){a in b.components&&(b.components[a].build(c,d),c.components_[a]=b.components[a])}))},b.Webcast.prototype.addCuepoint=function(b,c,d,e){var f={};if(this.isReady_){var g=this,h=e||"default",i={namespace:h,start:b,end:c,params:d||{}};i.onStart=function(b){a.each(g.components_,function(a,c){c.act("onStart",h,b)})},i.onEnd=function(b){a.each(g.components_,function(a,c){c.act("onEnd",h,b)})},f=this.player.addCuepoint(i),a.each(g.components_,function(a,b){b.act("setup",h,d)})}return f},b.Component=b.CoreObject.extend({init:function(b,c){this.name_=b;var d=["build","dispose"];a.each(d,function(a,b){c[b]=b in c&&"function"==typeof c[b]?c[b]:function(){}});var e=["setup","onStart","onEnd"];c.handlers=c.handlers||{},a.each(c.handlers,function(b,d){a.each(e,function(a,e){c.handlers[b][e]=e in d&&"function"==typeof d[e]?d[e]:function(){}})}),this.definition_=c}}),b.Component.prototype.definition_={},b.Component.prototype.webcast={},b.Component.prototype.name_="",b.Component.prototype.name=function(){return this.name_},b.Component.prototype.options={},b.Component.prototype.build=function(a,b){this.webcast=a,this.options=b||{},this.definition_.build.call(this,a,b)},b.Component.prototype.dispose=function(){this.definition_.dispose.call(this)},b.Component.prototype.act=function(a,b,c){b=b||"default",b in this.definition_.handlers&&a in this.definition_.handlers[b]&&this.definition_.handlers[b][a].call(this,c)},b.components={},b.component=function(a,c){return b.components[a]=new b.Component(a,c),b.components[a]},b.plugin=function(a,c){b.Webcast.prototype[a]=c},b.component("slideshow",{build:function(b,c){var d=this.el=a("<div id='slideshow'></div>");d.addClass("slideshow"),d.addClass("wsplayer"),d.addClass("wsp-component"),this.options.width&&d.css({width:c.width+"px"}),this.options.height&&d.css({height:c.height+"px"}),d.css({position:"relative"}),b.appendElement(d)},dispose:function(){this.el.parentNode&&this.el.parentNode.removeChild(this.el),this.el=null},handlers:{layout:{onStart:function(a){var b=this.webcast.options.components.layout.manifest[a.layout]||a.layout;b.slideshow?(b.slideshow.height&&this.el.css({height:b.slideshow.height+"px"}),b.slideshow.width&&(this.el.css({width:b.slideshow.width+"px"}),this.el.find("img").css({width:b.slideshow.width+"px"}))):(this.options.width&&(this.el.css({width:this.options.width+"px"}),this.el.find("img").css({width:this.options.width+"px"})),this.options.height&&this.el.css({height:this.options.height+"px"}))}},slideshow:{setup:function(b){var c=this.el.children("img#"+b.id);c.length?c.attr("src",b.src):(c=a("<img/>"),c.attr("id",b.id),c.attr("src",b.src),c.css({position:"absolute",top:"0px",left:"0px"}),this.options.width&&c.css({width:a(this.el).width()+"px"}),c.hide(),a(this.el).append(c)),c.css({"z-index":this.el.children("img").length})},onStart:function(a){var b=this.el.children("img#"+a.id);this.el.children("img:visible").length?(this.el.children("img:visible").fadeOut("slow"),b.fadeIn("slow")):b.fadeIn("slow"),this.el.height(b.height())},onEnd:function(a){var b=this.el.children("img#"+a.id);b.fadeOut()}}}}),b.component("layout",{build:function(a,b){b.manifest=b.manifest||{},this.currentLayout=""},handlers:{layout:{onStart:function(a){var b=this.options.manifest[a.layout]?this.options.manifest[a.layout]:a.layout;if(b.class!==this.currentLayout){var c=this;a.smooth?this.webcast.hide(function(){this.removeClass(c.currentLayout),this.addClass(b.class),c.currentLayout=b.class,this.show()}):(this.webcast.removeClass(this.currentLayout),this.webcast.addClass(b.class),this.currentLayout=b.class),b.video?this.webcast.player.dimensions(b.video.width||this.webcast.options.video.width,b.video.height||this.webcast.options.video.height):this.webcast.player.dimensions(this.webcast.options.video.width,this.webcast.options.video.height)}}}}})}(jQuery);